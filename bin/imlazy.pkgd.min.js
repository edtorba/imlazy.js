/*!
 * Imlazy.js PACKAGED v1.2.1
 * A lightweight vanilla JS plugin to lazy load images.
 *
 * Licensed MIT License (MIT)
 *
 * http://edtorba.com
 * Copyright 2016 Eduards Torba
 */
function Imlazy(t){this.defaults={preload:0},this.defaults=Object.assign(this.defaults,t),this.imageBucket=document.querySelectorAll("[data-imlazy]"),this.run=this.run.bind(this),this.run(),this.run=this.debounce(this.run,20),window.addEventListener("resize",this.run,!1),window.addEventListener("scroll",this.run,!1)}var proto=Imlazy.prototype;proto.run=function(){for(var t=0,e=this.imageBucket.length;t<e;t++){var n=this.imageBucket[t];this.isElementInView(n)&&this.load(n)}},proto.load=function(t){var e=t.getAttribute("data-imlazy"),n=window.innerWidth,i=null;if(null===e)return void console.error("imlazy: Couldn't retrieve JSON data for ",t);var o=this.parseJSON(e);if(void 0!==o){for(var r in o){var s=parseInt(r,10);s<=n&&(i=s)}var a=this;if(this.isImageElement(t))t.getAttribute("src")!==o[i]&&(t.setAttribute("src",o[i]),t.onload=function(e){a.classlist.contains(t,"is-loaded")||a.classlist.add(t,"is-loaded")},t.onerror=function(t){console.error("imlazy: Couldn't load ",o[i])});else if(t.style.backgroundImage.slice(4,-1).replace(/"/g,"")!==o[i]){var l=new Image;l.setAttribute("src",o[i]),l.onload=function(e){t.style.backgroundImage="url("+o[i]+")",a.classlist.contains(t,"is-loaded")||a.classlist.add(t,"is-loaded")},l.onerror=function(t){console.error("imlazy: Couldn't load ",o[i])}}}},proto.isElementInView=function(t,e){var n=t.getBoundingClientRect();return this.defaults.preload?n.bottom>0-this.defaults.preload&&n.top<(window.innerHeight||document.documentElement.clientHeight)+this.defaults.preload:n.bottom>0&&n.top<(window.innerHeight||document.documentElement.clientHeight)},proto.isImageElement=function(t){return t instanceof HTMLImageElement},proto.parseJSON=function(t){try{return JSON.parse(t)}catch(t){console.error("parseJson error: %s",t)}},proto.classlist={add:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];if(t.classList)for(var o=0,r=n.length;o<r;o++)t.classList.add(n[o]);else for(var s=0,a=n.length;s<a;s++)t.className+=" "+n[s]},contains:function(t,e){return t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className)}},proto.debounce=function(t,e,n){var i;return function(){var o=this,r=arguments,s=n&&!i;clearTimeout(i),i=setTimeout(function(){i=null,n||t.apply(o,r)},e),s&&t.apply(o,r)}},window.Imlazy=Imlazy,"assign"in Object||(Object.assign=function(t,e){for(var n,i,o=1;o<arguments.length;++o){i=arguments[o];for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t});